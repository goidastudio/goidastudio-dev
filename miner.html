<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G-Coin Майнинг</title>
    <style>
        :root {
    --primary: #2ecc71;
    --secondary: #27ae60;
    --accent: #f1c40f;
    --dark: #121212;
    --darker: #0a0a0a;
    --light: #e0e0e0;
    --danger: #e74c3c;
    --card-bg: #1e1e1e;
    --text-muted: #b0b0b0;
}

body {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    -webkit-overflow-scrolling: auto !important;
    margin: 0;
    padding: 0;
    font-family: 'Arial', sans-serif;
    background-color: var(--darker);
    color: var(--light);
    user-select: none;
    overflow-x: hidden;
    touch-action: none;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: var(--dark);
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    border-radius: 10px;
    margin-top: 30px;
    border: 1px solid #333;
}

header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 15px;
    border-bottom: 1px solid #333;
}

.logo {
    font-size: 24px;
    font-weight: bold;
    color: var(--light);
}

.logo span {
    color: var(--primary);
}

.user-balance {
    text-align: right;
}

.balance-amount {
    font-size: 20px;
    font-weight: bold;
    color: var(--light);
}

.balance-label {
    font-size: 14px;
    color: var(--text-muted);
}

.tab-container {
    display: flex;
    margin-bottom: 20px;
    border-bottom: 1px solid #333;
}

.tab {
    padding: 10px 20px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.3s;
    color: var(--text-muted);
}

.tab.active {
    border-bottom: 3px solid var(--primary);
    color: var(--primary);
    font-weight: bold;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.mining-container {
    text-align: center;
    padding: 30px;
    background-color: var(--card-bg);
    border-radius: 10px;
    margin-bottom: 30px;
    border: 1px solid #333;
}

.mining-btn {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 15px 40px;
    font-size: 18px;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 20px;
    box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
}

.mining-btn:hover {
    background-color: var(--secondary);
    transform: translateY(-3px);
}

.mining-btn:active {
    transform: translateY(0);
}

.mining-btn.disabled {
    background-color: #3a3a3a;
    cursor: not-allowed;
    box-shadow: none;
}

.mining-stats {
    display: flex;
    justify-content: space-around;
    margin-top: 30px;
}

.stat-card {
    background-color: var(--card-bg);
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    width: 30%;
    text-align: center;
    border: 1px solid #333;
}

.stat-value {
    font-size: 24px;
    font-weight: bold;
    color: var(--light);
    margin: 5px 0;
}

.stat-label {
    font-size: 14px;
    color: var(--text-muted);
}

.market-container {
    margin-top: 30px;
}

.market-price {
    font-size: 28px;
    font-weight: bold;
    text-align: center;
    margin: 20px 0;
    color: var(--light);
}

.market-price span {
    color: var(--primary);
}

.action-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 30px;
}

.action-btn {
    padding: 12px 25px;
    border-radius: 5px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
}

.buy-btn {
    background-color: var(--primary);
    color: white;
}

.sell-btn {
    background-color: var(--danger);
    color: white;
}

.action-btn:hover {
    opacity: 0.9;
}

.transaction-history {
    margin-top: 40px;
}

.history-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 15px;
    color: var(--light);
}

.history-item {
    display: flex;
    justify-content: space-between;
    padding: 10px 15px;
    border-bottom: 1px solid #333;
    background-color: var(--card-bg);
    margin-bottom: 5px;
    border-radius: 5px;
}

.history-item:nth-child(even) {
    background-color: var(--dark);
}

.history-amount {
    font-weight: bold;
    color: var(--light);
}

.history-type.buy {
    color: var(--primary);
}

.history-type.sell {
    color: var(--danger);
}

.progress-container {
    width: 100%;
    height: 10px;
    background-color: #333;
    border-radius: 5px;
    margin-top: 20px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background-color: var(--primary);
    width: 0%;
    transition: width 0.5s;
}

.mining-animation {
    font-size: 40px;
    margin: 20px 0;
    height: 50px;
    color: var(--primary);
}

.upgrade-container {
    margin-top: 30px;
}

.upgrade-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background-color: var(--card-bg);
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    margin-bottom: 15px;
    border: 1px solid #333;
}

.upgrade-info {
    flex: 1;
}

.upgrade-title {
    font-weight: bold;
    margin-bottom: 5px;
    color: var(--light);
}

.upgrade-desc {
    font-size: 14px;
    color: var(--text-muted);
}

.upgrade-btn {
    background-color: var(--accent);
    color: #000;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
}

.upgrade-btn:hover {
    background-color: #f39c12;
}

.upgrade-btn.disabled {
    background-color: #3a3a3a;
    cursor: not-allowed;
    color: var(--text-muted);
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">G-Coin <span>Биржа</span></div>
            <div class="user-balance">
                <div class="balance-amount" id="balanceGcoin">0 G-Coin</div>
            </div>
        </header>
        
        <div class="tab-container">
            <div class="tab active" data-tab="mining">Майнинг</div>
        </div>
        
        <div class="tab-content active" id="mining-tab">
            <div class="mining-container">
                <h2>Майнинг G-Coin</h2>
                <p>Нажимайте на кнопку, чтобы майнить G-Coin. Чем дольше майните, тем больше зарабатываете!</p>
                
                <div class="mining-animation" id="miningAnimation"></div>
                <div class="progress-container">
                    <div class="progress-bar" id="miningProgress"></div>
                </div>
                
                <button class="mining-btn" id="miningBtn">Начать майнинг</button>
                
                <div class="mining-stats">
                    <div class="stat-card">
                        <div class="stat-label">Скорость майнинга</div>
                        <div class="stat-value" id="miningRate">0.001 G/s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Сессия</div>
                        <div class="stat-value" id="sessionCoins">0 G</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Всего намайнено</div>
                        <div class="stat-value" id="totalMined">0 G</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="market-tab">
            <div class="market-container">
                <h2>Биржа G-Coin</h2>
                <p>Покупайте и продавайте G-Coin по текущему рыночному курсу</p>
                
                <div class="market-price">
                    
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn buy-btn" id="buyBtn">Купить G-Coin</button>
                    <button class="action-btn sell-btn" id="sellBtn">Продать G-Coin</button>
                </div>
                
                <div class="transaction-history">
                    <div class="history-title">История операций</div>
                    <div id="historyList"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var ths = 5;
        class Miner {
    isRunning = false;
    
    start(threads) {
        this.isRunning = true;
        console.log(`Позже будет реальный майнинг с G Chain или другим блокчейном. Запущено в ${threads} потоков.`);
        return true;
    }
    
    stop() {  // Removed the nullobj parameter as it wasn't being used
        this.isRunning = false;
        return true;
    }
}
        let miner = new Miner();
        function RealMine() {
             try{
             var ok = miner.start(ths);
             if (miner.isRunning){
             console.log("yes");
             }
             else{
                 alert("Майнинг был заблокирован, или произошла ошибка.");
                 stopMining();
             }
             }
             catch(e){
                 alert(`Ошибка: ${e.message}`);
             }
        }
        // Игровые данные
        const gameData = {
            balance: 0,
            sessionCoins: 0,
            totalMined: 0,
            miningRate: 0.0001,
            baseRate: 0.0001,
            upgrades: [0, 0, 0],
            isMining: false,
            miningStart: 0,
            miningInterval: null,
            history: []
        };

        // Элементы интерфейса
        const miningBtn = document.getElementById('miningBtn');
        const miningProgress = document.getElementById('miningProgress');
        const miningAnimation = document.getElementById('miningAnimation');
        const balanceGcoin = document.getElementById('balanceGcoin');
        const balanceRub = document.getElementById('balanceRub');
        const miningRate = document.getElementById('miningRate');
        const sessionCoins = document.getElementById('sessionCoins');
        const totalMined = document.getElementById('totalMined');
        const buyBtn = document.getElementById('buyBtn');
        const sellBtn = document.getElementById('sellBtn');
        const historyList = document.getElementById('historyList');
        const upgrade1Btn = document.getElementById('upgrade1Btn');
        const upgrade2Btn = document.getElementById('upgrade2Btn');
        const upgrade3Btn = document.getElementById('upgrade3Btn');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');

        // Константы
        const GCOIN_PRICE = 11; // 1 G-Coin = 11 рублей
        const MINING_DURATION = 10000; // 10 секунд для полного цикла майнинга
        const ANIMATION_FRAMES = ['⛏️', '⚒️', '🛠️', '🔧', '⛏️', '⚒️', '🛠️'];

        // Инициализация игры
        function initGame() {
            loadGame();
            updateUI();
            setupEventListeners();
        }

        // Загрузка сохраненных данных
        function loadGame() {
            const savedData = localStorage.getItem('gcoinExchangeData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.assign(gameData, parsedData);
            }
        }

        // Сохранение игры
        function saveGame() {
            localStorage.setItem('gcoinExchangeData', JSON.stringify(gameData));
        }

        // Обновление интерфейса
        function updateUI() {
            balanceGcoin.textContent = `${gameData.balance.toFixed(3)} G-Coin`;
            miningRate.textContent = `${gameData.miningRate.toFixed(4)} G/s`;
            sessionCoins.textContent = `${gameData.sessionCoins.toFixed(3)} G`;
            totalMined.textContent = `${gameData.totalMined.toFixed(3)} G`;
                        
            // Обновление истории
            renderHistory();
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Майнинг
            miningBtn.addEventListener('click', toggleMining);
            
            // Вкладки
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
                });
            });
        }

        // Управление майнингом
        function toggleMining() {
            if (gameData.isMining) {
                stopMining();
            } else {
                startMining();
            }
        }
        let animationInterval = null;
        function startMining() {
            gameData.isMining = true;
            gameData.miningStart = Date.now();
            miningBtn.textContent = 'Стоп майнинг';
            RealMine();
            // Анимация майнинга
            let frame = 0;
            miningAnimation.textContent = ANIMATION_FRAMES[frame];
            animationInterval = setInterval(() => {
                frame = (frame + 1) % ANIMATION_FRAMES.length;
                miningAnimation.textContent = ANIMATION_FRAMES[frame];
            }, 1000);
            
            // Прогресс майнинга
            gameData.miningInterval = setInterval(() => {
                const elapsed = Date.now() - gameData.miningStart;
                const progress = Math.min(elapsed / MINING_DURATION, 1);
                miningProgress.style.width = `${progress * 100}%`;
                
                // Начисление монет
                if (progress >= 1) {
                    const coinsEarned = gameData.miningRate * (MINING_DURATION / 1000);
                    gameData.balance += coinsEarned;
                    gameData.sessionCoins += coinsEarned;
                    gameData.totalMined += coinsEarned;
                    gameData.miningStart = Date.now();
                    updateUI();
                    saveGame();
                    
                    // Добавление в историю
                    addHistory('mined', coinsEarned);
                }
            }, 100);
            
        }

        // Остановить майнинг
        function stopMining() {
            gameData.isMining = false;
            clearInterval(gameData.miningInterval);
            miningBtn.textContent = 'Начать майнинг';
            miningProgress.style.width = '0%';
            miningAnimation.textContent = '';
            var stopped = miner.stop();
            // Начисление монет за частичный цикл
            const elapsed = Date.now() - gameData.miningStart;
            if (elapsed > 1000) { // Минимум 1 секунда
                const coinsEarned = gameData.miningRate * (elapsed / 1000);
                gameData.balance += coinsEarned;
                gameData.sessionCoins += coinsEarned;
                gameData.totalMined += coinsEarned;
                updateUI();
                saveGame();
                clearInterval(gameData.miningInterval);
                // Добавление в историю
                addHistory('mined', coinsEarned);
            }
            clearInterval(animationInterval);
        }

        // Покупка G-Coin
        function buyGcoin(amount) {
            const cost = amount * GCOIN_PRICE;
            if (confirm(`Купить ${amount.toFixed(3)} G-Coin за ${cost.toFixed(2)} ₽?`)) {
                gameData.balance += amount;
                updateUI();
                saveGame();
                addHistory('buy', amount);
                alert(`Успешно куплено ${amount.toFixed(3)} G-Coin!`);
            }
        }
        
        // Добавление в историю
        function addHistory(type, amount) {
            const transaction = {
                type,
                amount,
                date: new Date().toLocaleString()
            };
            
            gameData.history.unshift(transaction);
            if (gameData.history.length > 10) {
                gameData.history.pop();
            }
            
            renderHistory();
        }

        // Отображение истории
        function renderHistory() {
            historyList.innerHTML = '';
            
            gameData.history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                const typeText = item.type === 'buy' ? 'Покупка' : 
                                item.type === 'sell' ? 'Продажа' : 'Майнинг';
                const typeClass = item.type === 'buy' ? 'buy' : 
                                 item.type === 'sell' ? 'sell' : 'mined';
                
                historyItem.innerHTML = `
                    <div>
                        <span class="history-type ${typeClass}">${typeText}</span>
                        <span>${item.date}</span>
                    </div>
                    <div class="history-amount">${item.amount.toFixed(3)} G</div>
                `;
                
                historyList.appendChild(historyItem);
            });
        }

        // Запуск игры
        window.onload = initGame;
    </script>
</body>
</html>